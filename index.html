<!DOCTYPE html>
<html>
<head>
  <title>Scrolling Game</title>
  </head>
<body>

<canvas id="animationCanvas" width="1200" height="800" style="border:1px solid #000000;">

<script>
var background = new Image();
//background.src = "hs-2014-27-a-print.0.0.jpg";
//background.src = "4632537-rainforest-images.jpeg";
background.src = "sky-background.jpg";

var userSprite = new Image();
var harmSprite = new Image();
var benSprite = new Image();
userSprite.src = "userAirplane-sprite.png";
harmSprite.src = "enemyAirplane-sprite.png";
benSprite.src = "star-sprite.png";

var numLives = 3, score = 0, levelNum = 1;
var isPaused = true, gameOver = false;

var userX = 80, userY = 380; //Offset: X=140, Y=60; Radius: X=75, Y=40
var harmX = 1250 + Math.floor(Math.random() * (201));  //Offset: X=140, Y=160; Radius: X=75, Y=40
var harmY = (Math.floor(Math.random() * 7) + 1) * 100;
var harm2X = 1550 + Math.floor(Math.random() * (201)); 
var harm2Y = (Math.floor(Math.random() * 7) + 1) * 100;
var harm3X = 1850 + Math.floor(Math.random() * (201)); 
var harm3Y = (Math.floor(Math.random() * 7) + 1) * 100;
var benX = 1250 + Math.floor(Math.random() * (201));  //Offset: X=60, Y=60; Radius: 50
var benY = (Math.floor(Math.random() * 7) + 1) * 100;

var userOffsetX = 140, userOffsetY = 60;
var harmOffsetX = 140, harmOffsetY = 160;
var benOffsetX = 60, benOffsetY = 60;

var userRadiusX = 75, userRadiusY = 40;
var harmRadiusX = 75, harmRadiusY = 40;
var benRadiusX = 50, benRadiusY = 50;

var harmSpeed = 5, benSpeed = 4;

var c = document.getElementById("animationCanvas");   
var ctx = c.getContext("2d");
ctx.fillStyle = "red";

console.log(c.width, c.height);

function draw() {
  // clear the canvas
  ctx.clearRect(0, 0, c.width, c.height);


  document.onkeydown = function(e) {
    switch (e.keyCode) {
        case 32:
            if (!isPaused)// && !gameOver)
              isPaused = true;
            else
              isPaused = false;
            break;
        case 37:
            //alert('left');
            break;
        case 38:
            //alert('up');
            if (!isPaused && userY > 100)// && !gameOver)
              userY -= 40;
            break;
        case 39:
            //alert('right');
            break;
        case 40:
            //alert('down');
            if (!isPaused && userY < 700)// && !gameOver)
              userY += 40;
            break;
    }
  };
  
  // increment coord to "move" l to r

  if (!isPaused){// && !gameOver){
    harmX -= harmSpeed;
    harm2X -= harmSpeed;
    harm3X -= harmSpeed;
    benX -= benSpeed;
  }
  

  // Handles edge condition
  if (harmX < -50) {
    harmX = 1250 + Math.floor(Math.random() * (201));
    harmY = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (harm2X < -50) {
    harm2X = 1250 + Math.floor(Math.random() * (201));
    harm2Y = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (harm3X < -50) {
    harm3X = 1250 + Math.floor(Math.random() * (201));
    harm3Y = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (benX < -50) {
    benX = 1250 + Math.floor(Math.random() * (201));
    benY = (Math.floor(Math.random() * 7) + 1) * 100;
  }

  // Handles collision with user
  if (Math.abs(userX - benX) < (userRadiusX + benRadiusX) && Math.abs(userY - benY) < (userRadiusY + benRadiusY)) {
    score += 100;
    benX = 1250 + Math.floor(Math.random() * (201));
    benY = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (Math.abs(userX - harmX) < (userRadiusX + harmRadiusX) && Math.abs(userY - harmY) < (userRadiusY + harmRadiusY)) {
    numLives--;
    harmX = 1250 + Math.floor(Math.random() * (201));
    harmY = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (Math.abs(userX - harm2X) < (userRadiusX + harmRadiusX) && Math.abs(userY - harm2Y) < (userRadiusY + harmRadiusY)) {
    numLives--;
    harm2X = 1250 + Math.floor(Math.random() * (201));
    harm2Y = (Math.floor(Math.random() * 7) + 1) * 100;
  }
  if (Math.abs(userX - harm3X) < (userRadiusX + harmRadiusX) && Math.abs(userY - harm3Y) < (userRadiusY + harmRadiusY)) {  //(Math.hypot(harm3X-userX, harm3Y-userY) < 100) {
    numLives--;
    harm3X = 1250 + Math.floor(Math.random() * (201));
    harm3Y = (Math.floor(Math.random() * 7) + 1) * 100;
  }

  // Changing Levels
  if (levelNum == 1 && score == 500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 2 && score == 1000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 3 && score == 1500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 4 && score == 2000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 5 && score == 2500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 6 && score == 3000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 7 && score == 3500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 8 && score == 4000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 9 && score == 4500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 10 && score == 5000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 11 && score == 5500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 12 && score == 6000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 13 && score == 6500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 14 && score == 7000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 15 && score == 7500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 16 && score == 8000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 17 && score == 8500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 18 && score == 9000) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }
  if (levelNum == 19 && score == 9500) {
    levelNum++;
    harmSpeed++;
    benSpeed++;
  }


  // Check for game over
  if (numLives <= 0) {
    gameOver = true;
  }

  // draw objects

  // draw the background image
  ctx.drawImage(background, 0, 0);
  
  // Display Text
  ctx.fillStyle = "white";
  ctx.font = '24px serif';
  ctx.textAlign = 'left';
  ctx.fillText("Score: " + score, 5, 25);
  ctx.textAlign = 'center';
  ctx.fillText("Level " + levelNum, c.width/2, 25);
  ctx.textAlign = 'right';
  ctx.fillText("Lives: " + numLives, c.width - 5, 25);
  if (isPaused){
    ctx.textAlign = 'center';
    ctx.fillText("Paused", c.width/2, 45);
    ctx.fillStyle = "black";
    ctx.fillText("Space to Resume", c.width/2, 790);
  } 
  else if (gameOver){
    ctx.textAlign = 'center';
    ctx.fillText("Game Over", c.width/2, 50);
    ctx.fillStyle = "black";
    ctx.fillText("Refresh to Play Again", c.width/2, 790);
  }
  else {
    ctx.textAlign = 'center';
    ctx.fillStyle = "black";
    ctx.fillText("Space to Pause", c.width/2, 790);
  }

  // draw a circle
  // start a new path;  
  //  comment out begin and close path to see what happens
  /*
  // Harm 1
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(harmX, harmY, 50, 0, Math.PI * 2);
  ctx.fill();
  // Harm 2
  ctx.beginPath();
  ctx.arc(harm2X, harm2Y, 50, 0, Math.PI * 2);
  ctx.fill();
  // Harm 3
  ctx.beginPath();
  ctx.arc(harm3X, harm3Y, 50, 0, Math.PI * 2);
  ctx.fill();

  // User
  ctx.fillStyle = "blue";
  ctx.beginPath();
  ctx.arc(userX, userY, 50, 0, Math.PI * 2);
  ctx.fill();
  
  // Benefit
  ctx.fillStyle = "green";
  ctx.beginPath();
  ctx.arc(benX, benY, 50, 0, Math.PI * 2);

  //ctx.closePath();

  ctx.fill();
  */
  ctx.drawImage(userSprite, userX-userOffsetX, userY-userOffsetY);
  ctx.drawImage(benSprite, benX-benOffsetX, benY-benOffsetY);
  ctx.drawImage(harmSprite, harmX-harmOffsetX, harmY-harmOffsetY);
  ctx.drawImage(harmSprite, harm2X-harmOffsetX, harm2Y-harmOffsetY);
  ctx.drawImage(harmSprite, harm3X-harmOffsetX, harm3Y-harmOffsetY);

  // call again when available
  if (!gameOver)
    window.requestAnimationFrame(draw);
}


// kick it off
window.requestAnimationFrame(draw);


</script>

</body>
</html>
